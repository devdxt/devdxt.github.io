<!DOCTYPE html>
<html>
<head>
	<title>Test Armada</title>
	<link rel="stylesheet" type="text/css" href="/css/normalize.css">
	<link rel="stylesheet" type="text/css" href="/css/common.css">
	<link rel="stylesheet" type="text/css" href="/css/header.css">
	<link rel="stylesheet" type="text/css" href="/css/home.css">
	<link rel="stylesheet" type="text/css" href="/css/doc.css">
	<link rel="stylesheet" type="text/css" href="/css/training.css">
	<link rel="stylesheet" type="text/css" href="/css/faq.css">
	<link rel="stylesheet" type="text/css" href="/css/contact.css">
	<link rel="stylesheet" type="text/css" href="/css/search.css">
	<link rel="stylesheet" type="text/css" href="/css/custom.css">
	<link rel="stylesheet" type="text/css" href="/css/slick.css">
	<link rel="stylesheet" type="text/css" href="/css/prism.css">
	<link rel="stylesheet" type="text/css" href="/css/responsive.css">
	
	<link rel="shortcut icon" href="/documentation/images/favicon.ico">
	
</head>
<body>
	
	<header>
		<a href="/">
			<img src="/documentation/images/ta-logo.png" class="logo" alt="Main Brand Logo"
				 srcset="/documentation/images/ta-logo%402x.png 2x, /documentation/images/ta-logo%403x.png 3x">
		</a>
		<form action="/search" method="get">
			<input type="text" id="search-box" name="query" placeholder="Search" class="search-box">
			<div class="select-box">
				<select name="fleet" id="fleet-box" onchange="document.getElementById('search-box').focus();">
					<option value="all">All Fleets</option>
					
					<option value="Functional Testing">Functional Testing</option>
					
					<option value="Mocking">Mocking</option>
					
					<option value="Performance Testing">Performance Testing</option>
					
					<option value="Data Insights">Data Insights</option>
					
				</select>
			</div>
		</form>
		<div class="nav-links">
			
			<div class="nav-links__fleets">
				<a class="nav-links__fleets-btn">
					Fleets <img src="/images/arrow-down-icon.png" class="arrow-down-icon"
								srcset="/images/arrow-down-icon%402x.png 2x,
										/images/arrow-down-icon%403x.png 3x">
				</a>
				<div class="nav-links__fleets-content">
					<a href="/">
						All Fleets
					</a>
					
					<a href="/Functional Testing/">
						Functional Testing
					</a>
					
					<a href="/Mocking/">
						Mocking
					</a>
					
					<a href="/Performance Testing/">
						Performance Testing
					</a>
					
					<a href="/Data Insights/">
						Data Insights
					</a>
					
				</div>
			</div>
			
			
			
			
			<a href="/documentation/About.html" class="nav-links__main-links">About Us</a>
			
			
			
			
			
			
			<a href="/faq" class="nav-links__main-links">FAQ</a>
			
			
			
			<a href="https://github.com/TestArmada/" target="_blank" class="nav-links__main-links">GitHub</a>
			
		</div>
	</header>

	<div class="container">
		  <div class="clear"></div>
<div class="doc-container">
  <div class="breadcrumb doc-breadcrumb">
    <p>
      <a class="breadcrumb__link" href="/">Home</a>
      <img src="/images/arrow-right-icon.png"
           srcset="/images/arrow-right-icon@2x.png 2x,
                   /images/arrow-right-icon@3x.png 3x"
           class="arrow-right-icon">
      <a class="breadcrumb__link" href="/Functional Testing/">Functional Testing</a>
      <img src="/images/arrow-right-icon.png"
           srcset="/images/arrow-right-icon@2x.png 2x,
                   /images/arrow-right-icon@3x.png 3x"
           class="arrow-right-icon">
      <span class="breadcrumb__current-page">Native Android JAVA</span>
    </p>
  </div>
  <div class="clear"></div>
  <div class="sidebar">
    <ul>
    
    
    
    
    
    
    
    
      
      
        
          
          
            
            <li><a href="/documentation/Functional Testing/Native Android/JAVA/Introduction" class="sidebar__file-links">
              Introduction
            </a></li>
            
          
        
      
        
          
          
            
            <li><a href="/documentation/Functional Testing/Native Android/JAVA/Getting Started" class="sidebar__file-links sidebar__file-links-current">
              Getting Started
            </a></li>
            
          
        
      
        
          
            
            
              <li class="sidebar__file-links">Developer Guide</li>
            
          
          
          
            
            <li><a href="/Functional Testing/Native Android/JAVA/Training Guide" class="sidebar__file-links sidebar__file-sublink">
              Training Guide
            </a></li>
            
          
        
      
        
          
          
          
            
            <li><a href="/documentation/Functional Testing/Native Android/JAVA/API Guide" class="sidebar__file-links sidebar__file-sublink">
              API Guide
            </a></li>
            
          
        
      
        
          
          
          
            
            <li><a href="/documentation/Functional Testing/Native Android/JAVA/Boilerplates" class="sidebar__file-links sidebar__file-sublink">
              Boilerplates
            </a></li>
            
          
        
      
        
          
          
            
            <li><a href="/documentation/Functional Testing/Native Android/JAVA/Contribution Guide" class="sidebar__file-links">
              Contribution Guide
            </a></li>
            
          
        
      
        
          
          
            
            <li><a href="/documentation/Functional Testing/Native Android/JAVA/FAQ" class="sidebar__file-links">
              FAQ
            </a></li>
            
          
        
      
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    </ul>
  </div>
  <div class="doc-content markdown">
    <h3 id="prerequisite">Prerequisite</h3>
<p>Before configuring Flank and starting your Android test jobs, ensure <a href="https://www.python.org/downloads/">Python (&gt;= 2.7.x)</a> is installed on your local or CI slave, learn more <a href="https://cloud.google.com/sdk/downloads">here</a>.</p>

<h3 id="configuration-files">Configuration files</h3>

<h4 id="configproperties-optional-but-recommended">config.properties (optional but recommended)</h4>
<p>The <code class="highlighter-rouge">config.properties</code> file is used when you need to customize the Flank tests, all options can be seen <a href="https://github.com/TestArmada/flank#configure-flank">here</a>.</p>

<h4 id="service-accountjson-optional-but-recommended">service-account.json (optional but recommended)</h4>
<p>The file to provide <code class="highlighter-rouge">GCloud/Firebase</code> auth information, <a href="https://cloud.google.com/sdk/gcloud/reference/auth/activate-service-account">learn more</a>. Sample:</p>
<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"service_account"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"project_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Your Firebase project id"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"private_key_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Your private key id"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"private_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Your private key"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"client_email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The client email in Firebase"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"client_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The client id in Firebase"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"auth_uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://accounts.google.com/o/oauth2/auth"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"token_uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://accounts.google.com/o/oauth2/token"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"auth_provider_x509_cert_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.googleapis.com/oauth2/v1/certs"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"client_x509_cert_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.googleapis.com/robot/v1/metadata/x509/walmart-fb668%40appspot.gserviceaccount.com"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>
<p>If not set, the Flank test will default point to default Walmart Firebase project <code class="highlighter-rouge">walmart-fb668</code>.</p>

<h4 id="looperyml-required-in-looper">.looper.yml (required in looper)</h4>
<p>If you need run your test in a CI environment like looper, a looper config file is needed, learn more <a href="http://looper.walmart.com/docs/general/looper-yml.html">here</a>.</p>

<h4 id="environment-variables">Environment variables</h4>
<p>All environment variables can be found in the <a href="https://gecgithub01.walmart.com/otto/docs/blob/new-portal/Functional%20Testing/Native%20Android/JAVA/DeveloperGuide.md#environment-variables">Developer Guide</a></p>

<h4 id="looper-integration">Looper integration:</h4>
<p>In looper you can inherit from the Flank base looper job in your <code class="highlighter-rouge">.yml</code> file: <code class="highlighter-rouge">inherit: 'job://otto-Android_native'</code> it will include all default environment variables, can override them in your <code class="highlighter-rouge">.yml</code> anytime, or customize environment variables yourself from the beginning.</p>

<h5 id="looperyml-sample">.looper.yml sample</h5>
<div class="language-yml highlighter-rouge"><pre class="highlight"><code><span class="s">inherit</span><span class="pi">:</span> <span class="s1">'</span><span class="s">job://otto-Android_native'</span>

<span class="s">envs</span><span class="pi">:</span>
  <span class="s">global</span><span class="pi">:</span>
    <span class="s">variables</span><span class="pi">:</span>
      <span class="s">APK_PATH</span><span class="pi">:</span> <span class="s">./ExampleTestProject_AndroidStudio/app/build/outputs/apk/app-debug.apk</span>
      <span class="s">TEST_APK_PATH</span><span class="pi">:</span> <span class="s">./ExampleTestProject_AndroidStudio/app/build/outputs/apk/app-debug-androidTest.apk</span>
      <span class="s">PACKAGE</span><span class="pi">:</span> <span class="s1">'</span><span class="s">'</span>
      <span class="c1">#FAIL_JOB_ON_TEST_FAIL: false</span>

<span class="s">flows</span><span class="pi">:</span>
  <span class="s">default</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">./apk_build.sh</span>
    <span class="pi">-</span> <span class="s">shell (name run_tests)</span><span class="pi">:</span> <span class="pi">|</span>
           <span class="no">curl --header "Authorization: token ${GH_API_TOKEN}" \</span>
           <span class="no">--header "Accept: application/vnd.github.v3.raw" \</span>
           <span class="no">--location https://gecgithub01.walmart.com/api/v3/repos/otto/scripts/contents/looper/flank/flank.sh?ref=${BUILD_URL_REF} | bash</span>

</code></pre>
</div>

<h5 id="tests-results">Tests results</h5>
<p>The results are published to <a href="https://walmart.slack.com/messages/android_test">slack</a>.</p>

<p>Script will exit with error code 1 if there are any test failures, which means that it will fail the looper build.</p>

<h3 id="manual-setup">Manual setup</h3>
<p>Manual setup is as easy as automation, just follow steps:</p>

<ol>
  <li>Export all required environment variables</li>
  <li><strong>Recommended step:</strong> Create <code class="highlighter-rouge">config.properties</code> followed above instruction</li>
  <li><strong>Recommended step:</strong> Create <code class="highlighter-rouge">service-account.json</code> followed above instruction</li>
  <li>Run scripts <code class="highlighter-rouge">curl --header "Authorization: token ${GH_API_TOKEN}" --header "Accept: application/vnd.github.v3.raw" --location https://gecgithub01.walmart.com/api/v3/repos/otto/scripts/contents/looper/flank/flank.sh?ref=${BUILD_URL_REF} | bash</code></li>
</ol>

<h4 id="manual-setup-sample">Manual setup sample</h4>
<div class="highlighter-rouge"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>
<span class="nb">export </span><span class="nv">GH_API_TOKEN</span><span class="o">=</span>2a73a73566c54ee7152e1698374b9fd497c635df
<span class="nb">export </span><span class="nv">APK_PATH</span><span class="o">=</span>./build/outputs/apk/<span class="k">*</span>-debug.apk
<span class="nb">export </span><span class="nv">TEST_APK_PATH</span><span class="o">=</span>./build/outputs/apk/<span class="k">*</span>-debug-androidTest.apk
<span class="nb">export </span><span class="nv">PACKAGE</span><span class="o">=</span><span class="s1">''</span>
<span class="c">#export FAIL_JOB_ON_TEST_FAIL=false</span>
<span class="nb">export </span><span class="nv">BUILD_URL_REF</span><span class="o">=</span><span class="s1">'flank_beta'</span>
curl --header <span class="s2">"Authorization: token </span><span class="k">${</span><span class="nv">GH_API_TOKEN</span><span class="k">}</span><span class="s2">"</span> <span class="se">\</span>
--header <span class="s2">"Accept: application/vnd.github.v3.raw"</span> <span class="se">\</span>
--location https://gecgithub01.walmart.com/api/v3/repos/otto/scripts/contents/looper/flank/flank.sh?ref<span class="o">=</span><span class="k">${</span><span class="nv">BUILD_URL_REF</span><span class="k">}</span> | bash
</code></pre>
</div>

  </div>
  <div class="clear"></div>
</div>
<script type="text/javascript">
  var elements = document.getElementsByClassName('highlight');
  for (var i = 0; i < elements.length; i++) {
    elements[i].className += " line-numbers";
    if (!elements[i].parentElement.classList.value.match(/language/)) {
      elements[i].children[0].className = "language-javascript";
    }
  }
</script>
<script type="text/javascript" src="/js/prism.js"></script>
<script src="/js/jquery-3.3.1.min.js"></script>
<script src="/js/doc.js"></script>
	</div>

	<footer>
		<img class="left-footer-logo" alt="Left Footer Logo"
			 src="/documentation/images/dxt-logo.png"
			 srcset="/documentation/images/dxt-logo%402x.png 2x,
					 /documentation/images/dxt-logo%403x.png 3x">
		
		<span class="copyright">&copy; 2018 Walmart Inc.</span>
		
		<img class="right-footer-logo" alt="Right Footer Logo"
			 src="/documentation/images/walmartlabs-logo.png"
			 srcset="/documentation/images/walmartlabs-logo%402x.png 2x,
			 		 /documentation/images/walmartlabs-logo%403x.png 3x">
	</footer>

</body>
</html>
